// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`#fetchFindings should collect data and build relationships with image scan and cve 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Assessment",
      ],
      "_key": "sysdig_image_scan:17144f2f45c295bc2fdcae5db51044ca",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "fixablePackages": Array [],
            "id": "17144f2f45c295bc2fdcae5db51044ca",
            "isEVEEnabled": false,
            "labels": null,
            "metadata": Object {
              "architecture": "amd64",
              "author": "",
              "baseOS": "debian 11.5",
              "createdAt": "2022-09-13T00:56:19.369186372Z",
              "digest": "debian@sha256:73060f9fdf46e142b63fddde45759f12aea093156445c32ab667338d0563f5c4",
              "imageId": "sha256:43d28810c1b4c28a1be3bac8e0e40fcc472b2bfcfcda952544ed99cb874d2b1a",
              "labels": null,
              "layersCount": 1,
              "os": "linux",
              "pullString": "debian",
              "size": 129313792,
            },
            "packageCount": 96,
            "packageTypes": Array [
              "os",
            ],
            "policyEvaluations": Array [
              Object {
                "creationTimestamp": "2022-09-02T11:58:59.03062Z",
                "evaluationResult": "failed",
                "failuresCount": Object {
                  "imageConfigCreationDate": 0,
                  "imageConfigDefaultUser": 0,
                  "imageConfigEnvVariable": 0,
                  "imageConfigInstructionIsPkgManager": 0,
                  "imageConfigInstructionNotRecommended": 0,
                  "imageConfigLabel": 0,
                  "imageConfigSensitiveInformationAndSecrets": 0,
                  "vulnDenyList": 0,
                  "vulnSeverityAndThreats": 2,
                },
                "id": "17144f2f45c295bc9785414e83306ba9",
                "identifier": "sysdig_best_practices",
                "name": "Sysdig Best Practices",
                "policyType": "alwaysApply",
                "updateTimestamp": "2022-09-02T11:58:59.03062Z",
              },
            ],
            "runningFixablePackages": null,
            "storedAt": "2022-09-13T03:53:46.858993084Z",
            "type": "dockerImage",
            "vulnsBySev": Array [
              Object {
                "fixableCount": 0,
                "totalCount": 0,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 0,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 1,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 5,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 0,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 1,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 5,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 52,
              },
            ],
          },
        },
      ],
      "_type": "sysdig_image_scan",
      "category": "Image Scan",
      "createdOn": undefined,
      "displayName": "debian sha256:43d28810c1b4c28a1be3bac8e0e40fcc472b2bfcfcda952544ed99cb874d2b1a",
      "fixablePackages": Array [],
      "id": "17144f2f45c295bc2fdcae5db51044ca",
      "internal": false,
      "metadata.architecture": "amd64",
      "metadata.author": "",
      "metadata.baseOS": "debian 11.5",
      "metadata.createdAt": 1663030579369,
      "metadata.digest": "debian@sha256:73060f9fdf46e142b63fddde45759f12aea093156445c32ab667338d0563f5c4",
      "metadata.imageId": "sha256:43d28810c1b4c28a1be3bac8e0e40fcc472b2bfcfcda952544ed99cb874d2b1a",
      "metadata.labels": null,
      "metadata.layersCount": 1,
      "metadata.os": "linux",
      "metadata.pullString": "debian",
      "metadata.size": 129313792,
      "name": "debian sha256:43d28810c1b4c28a1be3bac8e0e40fcc472b2bfcfcda952544ed99cb874d2b1a",
      "packageCount": 96,
      "packageTypes": Array [
        "os",
      ],
      "runningFixablePackages": null,
      "storedAt": 1663041226858,
      "summary": "Image Scan",
      "type": "dockerImage",
      "vulnsBySev": Array [
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
      ],
    },
    Object {
      "_class": Array [
        "Assessment",
      ],
      "_key": "sysdig_image_scan:17140adb60b1639a2f8d615f88de1bfa",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "fixablePackages": Array [
              Object {
                "exploitCount": 0,
                "id": "17140adb60b1639ad35b4c1a76a5fba9",
                "name": "libpcre2-8-0",
                "suggestedFix": "10.36-2+deb11u1",
                "type": "os",
                "version": "10.36-2",
                "vulnsBySev": Array [
                  0,
                  0,
                  2,
                  0,
                  0,
                  0,
                  0,
                  0,
                ],
              },
              Object {
                "exploitCount": 0,
                "id": "17140adb60b1639a3c88473e6e13338a",
                "name": "zlib1g",
                "suggestedFix": "1:1.2.11.dfsg-2+deb11u2",
                "type": "os",
                "version": "1:1.2.11.dfsg-2+deb11u1",
                "vulnsBySev": Array [
                  0,
                  0,
                  1,
                  0,
                  0,
                  0,
                  0,
                  0,
                ],
              },
              Object {
                "exploitCount": 0,
                "id": "17140adb60b1639a39c15c260c5fdaf2",
                "name": "libc6",
                "suggestedFix": "2.31-13+deb11u4",
                "type": "os",
                "version": "2.31-13+deb11u3",
                "vulnsBySev": Array [
                  0,
                  0,
                  0,
                  1,
                  0,
                  0,
                  0,
                  6,
                ],
              },
              Object {
                "exploitCount": 0,
                "id": "17140adb60b1639aaa5ddbdf428888b5",
                "name": "libc-bin",
                "suggestedFix": "2.31-13+deb11u4",
                "type": "os",
                "version": "2.31-13+deb11u3",
                "vulnsBySev": Array [
                  0,
                  0,
                  0,
                  1,
                  0,
                  0,
                  0,
                  6,
                ],
              },
            ],
            "id": "17140adb60b1639a2f8d615f88de1bfa",
            "isEVEEnabled": false,
            "labels": null,
            "metadata": Object {
              "architecture": "amd64",
              "author": "",
              "baseOS": "debian 11.4",
              "createdAt": "2022-08-23T00:20:40.700966019Z",
              "digest": "debian@sha256:d52921d97310d0bd48dab928548ef539d5c88c743165754c57cfad003031386c",
              "imageId": "sha256:dd8bae8d259fed93eb54b3bca0adeb647fc07f6ef16745c8ed4144ada4d51a95",
              "labels": null,
              "layersCount": 1,
              "os": "linux",
              "pullString": "debian",
              "size": 129216000,
            },
            "packageCount": 96,
            "packageTypes": Array [
              "os",
            ],
            "policyEvaluations": Array [
              Object {
                "creationTimestamp": "2022-09-02T11:58:59.03062Z",
                "evaluationResult": "failed",
                "failuresCount": Object {
                  "imageConfigCreationDate": 0,
                  "imageConfigDefaultUser": 0,
                  "imageConfigEnvVariable": 0,
                  "imageConfigInstructionIsPkgManager": 0,
                  "imageConfigInstructionNotRecommended": 0,
                  "imageConfigLabel": 0,
                  "imageConfigSensitiveInformationAndSecrets": 0,
                  "vulnDenyList": 0,
                  "vulnSeverityAndThreats": 13,
                },
                "id": "17140adb60b1639a9bc2d5b0f765e4d2",
                "identifier": "sysdig_best_practices",
                "name": "Sysdig Best Practices",
                "policyType": "alwaysApply",
                "updateTimestamp": "2022-09-02T11:58:59.03062Z",
              },
            ],
            "runningFixablePackages": null,
            "storedAt": "2022-09-12T07:01:39.742909338Z",
            "type": "dockerImage",
            "vulnsBySev": Array [
              Object {
                "fixableCount": 0,
                "totalCount": 0,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 0,
              },
              Object {
                "fixableCount": 3,
                "totalCount": 4,
              },
              Object {
                "fixableCount": 2,
                "totalCount": 7,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 0,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 1,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 5,
              },
              Object {
                "fixableCount": 0,
                "totalCount": 52,
              },
            ],
          },
        },
      ],
      "_type": "sysdig_image_scan",
      "category": "Image Scan",
      "createdOn": undefined,
      "displayName": "debian sha256:dd8bae8d259fed93eb54b3bca0adeb647fc07f6ef16745c8ed4144ada4d51a95",
      "fixablePackages": Array [
        Object {
          "exploitCount": 0,
          "id": "17140adb60b1639ad35b4c1a76a5fba9",
          "name": "libpcre2-8-0",
          "suggestedFix": "10.36-2+deb11u1",
          "type": "os",
          "version": "10.36-2",
          "vulnsBySev": Array [
            0,
            0,
            2,
            0,
            0,
            0,
            0,
            0,
          ],
        },
        Object {
          "exploitCount": 0,
          "id": "17140adb60b1639a3c88473e6e13338a",
          "name": "zlib1g",
          "suggestedFix": "1:1.2.11.dfsg-2+deb11u2",
          "type": "os",
          "version": "1:1.2.11.dfsg-2+deb11u1",
          "vulnsBySev": Array [
            0,
            0,
            1,
            0,
            0,
            0,
            0,
            0,
          ],
        },
        Object {
          "exploitCount": 0,
          "id": "17140adb60b1639a39c15c260c5fdaf2",
          "name": "libc6",
          "suggestedFix": "2.31-13+deb11u4",
          "type": "os",
          "version": "2.31-13+deb11u3",
          "vulnsBySev": Array [
            0,
            0,
            0,
            1,
            0,
            0,
            0,
            6,
          ],
        },
        Object {
          "exploitCount": 0,
          "id": "17140adb60b1639aaa5ddbdf428888b5",
          "name": "libc-bin",
          "suggestedFix": "2.31-13+deb11u4",
          "type": "os",
          "version": "2.31-13+deb11u3",
          "vulnsBySev": Array [
            0,
            0,
            0,
            1,
            0,
            0,
            0,
            6,
          ],
        },
      ],
      "id": "17140adb60b1639a2f8d615f88de1bfa",
      "internal": false,
      "metadata.architecture": "amd64",
      "metadata.author": "",
      "metadata.baseOS": "debian 11.4",
      "metadata.createdAt": 1661214040700,
      "metadata.digest": "debian@sha256:d52921d97310d0bd48dab928548ef539d5c88c743165754c57cfad003031386c",
      "metadata.imageId": "sha256:dd8bae8d259fed93eb54b3bca0adeb647fc07f6ef16745c8ed4144ada4d51a95",
      "metadata.labels": null,
      "metadata.layersCount": 1,
      "metadata.os": "linux",
      "metadata.pullString": "debian",
      "metadata.size": 129216000,
      "name": "debian sha256:dd8bae8d259fed93eb54b3bca0adeb647fc07f6ef16745c8ed4144ada4d51a95",
      "packageCount": 96,
      "packageTypes": Array [
        "os",
      ],
      "runningFixablePackages": null,
      "storedAt": 1662966099742,
      "summary": "Image Scan",
      "type": "dockerImage",
      "vulnsBySev": Array [
        0,
        0,
        3,
        2,
        0,
        0,
        0,
        0,
      ],
    },
  ],
  "encounteredTypes": Array [
    "sysdig_image_scan",
  ],
  "numCollectedEntities": 2,
}
`;
